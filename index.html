<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>诺曼底登陆 - 塔防游戏</title>
    <link rel="stylesheet" href="src/styles.css">
</head>
<body>
    <!-- 游戏主菜单 -->
    <div id="menu" class="menu">
        <h1>⚔️ 诺曼底登陆 🏰</h1>
        <p class="subtitle">塔防游戏 - 守住防线！</p>
        <div class="menu-buttons">
            <button id="btn-classic" class="btn-primary">🎯 经典模式</button>
            <button id="btn-endless" class="btn-primary">♾️ 无尽模式</button>
        </div>
        <div class="menu-footer">
            <button id="btn-tutorial" class="btn-text">📖 游戏指南</button>
        </div>
    </div>

    <!-- 新手教学页 -->
    <div id="tutorial" class="tutorial hidden">
        <h1>📖 游戏指南</h1>
        <div class="tutorial-content">
            
            <div class="tutorial-section">
                <h3>🎯 游戏目标</h3>
                <p>在敌军突破你的防线之前消灭它们！</p>
                <ul>
                    <li>❤️ 生命值归零 = 游戏失败</li>
                    <li>🏆 经典模式存活10波 = 胜利</li>
                    <li>♾️ 无尽模式尽可能活得久</li>
                </ul>
            </div>

            <div class="tutorial-section">
                <h3>🔄 基本流程</h3>
                <div class="flow-steps">
                    <div class="step">
                        <span class="step-icon">⏱️</span>
                        <span class="step-text">准备期<br><small>布置防御塔</small></span>
                    </div>
                    <span class="step-arrow">→</span>
                    <div class="step">
                        <span class="step-icon">⚔️</span>
                        <span class="step-text">开战<br><small>自动攻击</small></span>
                    </div>
                    <span class="step-arrow">→</span>
                    <div class="step">
                        <span class="step-icon">💰</span>
                        <span class="step-text">结算<br><small>部分塔会撤退</small></span>
                    </div>
                </div>
            </div>

            <div class="tutorial-section">
                <h3>🏗️ 防御塔策略</h3>
                <p>不同塔有不同专长，合理搭配是关键：</p>
                <ul>
                    <li>🔫 <strong>机枪塔</strong> - 射速快，适合清杂兵</li>
                    <li>💥 <strong>加农炮</strong> - 破甲+溅射，对付重甲集群</li>
                    <li>🎯 <strong>狙击塔</strong> - 超远射程，点杀高威胁目标</li>
                    <li>⚡ <strong>激光塔</strong> - 减速效果，拦截快速单位</li>
                    <li>🌀 <strong>电磁塔</strong> - 眩晕控制，创造集火窗口</li>
                </ul>
                <p class="tip">💡 <strong>升级 vs 数量</strong>：全局升级影响所有同类型塔，但成本递增；多摆塔覆盖面广，但有维护费压力。</p>
            </div>

            <div class="tutorial-section">
                <h3>👹 敌军威胁</h3>
                <p>敌军会一波比一波强，而且它们会反击！</p>
                <ul>
                    <li>🎖️ 越往后敌人血量越高、数量越多</li>
                    <li>⚠️ 部分敌人会攻击并摧毁你的防御塔</li>
                    <li>🛡️ 重甲敌人需要破甲塔才能有效伤害</li>
                    <li>💨 快速单位需要减速或高射速塔拦截</li>
                </ul>
            </div>

            <div class="tutorial-section">
                <h3>💰 经济取舍</h3>
                <p>金币永远不够用，学会取舍：</p>
                <ul>
                    <li>✅ 击杀敌人获得金币</li>
                    <li>✅ 每波结算时部分塔会返还金币</li>
                    <li>⚠️ 每波开始要支付塔的维护费（等级越高越贵）</li>
                    <li>⚠️ 后期击杀收益递减，前期布局很重要</li>
                </ul>
                <p class="tip">💡 <strong>核心策略</strong>：前期省钱布局，中期针对性升级，后期靠已有防线硬抗。</p>
            </div>

        </div>

        <div class="tutorial-footer">
            <label class="checkbox-label">
                <input type="checkbox" id="skip-tutorial-checkbox">
                <span>不再显示此教程</span>
            </label>
            <button id="btn-start-game" class="btn-primary">🎮 开始游戏</button>
        </div>
    </div>

    <!-- 游戏画布 -->
    <canvas id="gameCanvas"></canvas>

    <!-- 游戏内 HUD -->
    <div id="hud" class="hud hidden">
        <div class="hud-left">
            <span class="hud-item">🌊 波次: <span id="wave">1</span></span>
            <span class="hud-item">❤️ 生命: <span id="lives">10</span></span>
            <span class="hud-item">💰 金币: <span id="gold">100</span></span>
        </div>
        <div class="hud-center">
            <span id="mode-display"></span>
            <span id="countdown" class="countdown hidden">⚠️ 敌军来袭: <span id="countdown-time">8</span>秒</span>
        </div>
        <div class="hud-right">
            <span id="combo-display" class="combo-display hidden">Combo x3! 💥</span>
            <span id="btn-pause" class="pause-btn">⏸</span>
            <span id="btn-speed" class="speed-btn">1x</span>
            <span class="hud-item">💀 击杀: <span id="kills">0</span></span>
            <span class="hud-item">⭐ 等级: <span id="level">1</span></span>
        </div>
    </div>

    <!-- 暂停菜单 -->
    <div id="pause-menu" class="pause-menu hidden">
        <div class="pause-content">
            <h2>⏸️ 游戏暂停</h2>
            <div class="pause-buttons">
                <button id="btn-resume" class="btn-primary">▶️ 继续游戏</button>
                <button id="btn-restart-pause" class="btn-secondary">🔄 重新开始</button>
                <button id="btn-menu-pause" class="btn-secondary">🏠 返回主菜单</button>
                <button id="btn-sound-toggle" class="btn-secondary">🔊 音效: 开</button>
            </div>
        </div>
    </div>

    <!-- 塔选择面板 -->
    <div id="tower-panel" class="tower-panel hidden">
        <div class="tower-type" data-type="machinegun" data-unlock="0">
            <div class="tower-icon">🔫</div>
            <div class="tower-name">机枪塔</div>
            <div class="tower-cost">💰 50</div>
        </div>
        <div class="tower-type" data-type="cannon" data-unlock="0">
            <div class="tower-icon">💥</div>
            <div class="tower-name">加农炮</div>
            <div class="tower-cost">💰 100</div>
        </div>
        <div class="tower-type" data-type="rifle" data-unlock="3">
            <div class="tower-icon">🎯</div>
            <div class="tower-name">狙击塔</div>
            <div class="tower-cost">💰 75</div>
            <div class="tower-lock">🔒 第3波解锁</div>
        </div>
        <div class="tower-type" data-type="laser" data-unlock="5">
            <div class="tower-icon">⚡</div>
            <div class="tower-name">激光塔</div>
            <div class="tower-cost">💰 125</div>
            <div class="tower-lock">🔒 第5波解锁</div>
        </div>
        <div class="tower-type" data-type="em" data-unlock="7">
            <div class="tower-icon">🌀</div>
            <div class="tower-name">电磁塔</div>
            <div class="tower-cost">💰 150</div>
            <div class="tower-lock">🔒 第7波解锁</div>
        </div>
        <div class="tower-type" data-type="rocket" data-unlock="10">
            <div class="tower-icon">🚀</div>
            <div class="tower-name">火箭塔</div>
            <div class="tower-cost">💰 200</div>
            <div class="tower-lock">🔒 第10波解锁</div>
        </div>
    </div>

    <!-- 塔类型升级面板 -->
    <div id="upgrade-panel" class="upgrade-panel hidden">
        <div class="upgrade-item">
            <button id="btn-upgrade-machinegun" class="btn-upgrade-type">机枪塔 Lv.1 → 2 (50)</button>
        </div>
        <div class="upgrade-item">
            <button id="btn-upgrade-cannon" class="btn-upgrade-type">加农炮 Lv.1 → 2 (100)</button>
        </div>
        <div class="upgrade-item">
            <button id="btn-upgrade-rifle" class="btn-upgrade-type">狙击塔 Lv.1 → 2 (75)</button>
        </div>
        <div class="upgrade-item">
            <button id="btn-upgrade-laser" class="btn-upgrade-type">激光塔 Lv.1 → 2 (125)</button>
        </div>
        <div class="upgrade-item">
            <button id="btn-upgrade-em" class="btn-upgrade-type">电磁塔 Lv.1 → 2 (150)</button>
        </div>
        <div class="upgrade-item">
            <button id="btn-upgrade-rocket" class="btn-upgrade-type">火箭塔 Lv.1 → 2 (200)</button>
        </div>
    </div>

    <!-- 结算界面 -->
    <div id="gameover" class="gameover hidden">
        <h2 id="gameover-title">游戏结束</h2>
        <p id="gameover-reason" class="gameover-reason"></p>
        <div class="stats">
            <div class="stat-item">
                <span class="stat-label">🏆 最终等级</span>
                <span class="stat-value" id="final-level">1</span>
            </div>
            <div class="stat-item">
                <span class="stat-label">💀 击杀敌军</span>
                <span class="stat-value" id="final-kills">0</span>
            </div>
            <div class="stat-item">
                <span class="stat-label">🌊 坚持波次</span>
                <span class="stat-value" id="final-wave">1</span>
            </div>
            <div class="stat-item">
                <span class="stat-label">🎮 游戏模式</span>
                <span class="stat-value" id="final-mode">经典</span>
            </div>
        </div>
        <div class="gameover-buttons">
            <button id="btn-restart" class="btn-primary">🔄 重新开始</button>
            <button id="btn-menu" class="btn-secondary">🏠 返回主菜单</button>
        </div>
    </div>

    <!-- 脚本加载 -->
    <script type="module" src="src/main.js"></script>
</body>
</html>
